{"ast":null,"code":"import _classCallCheck from \"/Users/matthewpugh/Projects/family-context-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/matthewpugh/Projects/family-context-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/matthewpugh/Projects/family-context-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/matthewpugh/Projects/family-context-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/matthewpugh/Projects/family-context-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/matthewpugh/Projects/family-context-ui/src/pages/SearchPage.tsx\";\nimport React from 'react';\nimport CaseIdSearch from '../components/SearchPage/CaseIdSearch';\nimport InfoSearch from '../components/SearchPage/InfoSearch';\nimport DataContent from '../components/DataContent';\nimport { Text } from '../tools/ConfigurableContent';\nimport { getHash } from '../tools/Obfuscation';\n\nvar SearchPage = /*#__PURE__*/function (_React$Component) {\n  _inherits(SearchPage, _React$Component);\n\n  function SearchPage(props) {\n    var _this;\n\n    _classCallCheck(this, SearchPage);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(SearchPage).call(this, props));\n    _this.state = {};\n    return _this;\n  }\n\n  _createClass(SearchPage, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      this.props.client.isSearchApiSupported().then(function (result) {\n        _this2.setState({\n          searchApiSupportedResult: result\n        });\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      return React.createElement(\"div\", {\n        id: \"SearchPage\",\n        className: \"SearchPage\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 32\n        },\n        __self: this\n      }, React.createElement(\"h1\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 33\n        },\n        __self: this\n      }, \"Find Service Involvement\"), React.createElement(\"div\", {\n        className: \"govuk-hint\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 34\n        },\n        __self: this\n      }, Text.Search.Introduction), React.createElement(DataContent, {\n        result: this.state.searchApiSupportedResult,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 37\n        },\n        __self: this\n      }, React.createElement(InfoSearch, {\n        search: function search(info) {\n          return navigateToSearch(info, _this3.props);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 38\n        },\n        __self: this\n      })), React.createElement(CaseIdSearch, {\n        search: function search(caseId) {\n          return searchForCaseId(caseId, _this3.props);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 40\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return SearchPage;\n}(React.Component);\n\nfunction searchForCaseId(caseId, props) {\n  setButtonsDisabledStatus(true);\n  return props.client.getPerson(caseId, \"cms\").then(function (response) {\n    setButtonsDisabledStatus(false);\n\n    if (response.success) {\n      var _response$data, _response$data2;\n\n      props.history.push({\n        pathname: \"/person/\".concat((_response$data = response.data) === null || _response$data === void 0 ? void 0 : _response$data.id),\n        hash: getHash({\n          personId: ((_response$data2 = response.data) === null || _response$data2 === void 0 ? void 0 : _response$data2.id) || \"\"\n        }),\n        state: {\n          personDetailsResult: response\n        }\n      });\n      return true;\n    }\n\n    return false;\n  });\n}\n\nfunction setButtonsDisabledStatus(status) {\n  var _document$getElementB;\n\n  var buttons = ((_document$getElementB = document.getElementById(\"SearchPage\")) === null || _document$getElementB === void 0 ? void 0 : _document$getElementB.getElementsByClassName(\"govuk-button\")) || [];\n\n  for (var index = 0; index < buttons.length; index++) {\n    if (status) {\n      buttons[index].setAttribute('disabled', 'true');\n    } else {\n      buttons[index].removeAttribute('disabled');\n    }\n  }\n}\n\nfunction navigateToSearch(info, props) {\n  var queryParams = \"\";\n\n  for (var parameter in info) {\n    queryParams += \"\".concat(parameter, \"=\").concat(info[parameter], \"&\");\n  }\n\n  queryParams.substring(0, queryParams.length - 1);\n  props.history.push(\"search?\" + queryParams);\n}\n\nexport default SearchPage;","map":{"version":3,"sources":["/Users/matthewpugh/Projects/family-context-ui/src/pages/SearchPage.tsx"],"names":["React","CaseIdSearch","InfoSearch","DataContent","Text","getHash","SearchPage","props","state","client","isSearchApiSupported","then","result","setState","searchApiSupportedResult","Search","Introduction","info","navigateToSearch","caseId","searchForCaseId","Component","setButtonsDisabledStatus","getPerson","response","success","history","push","pathname","data","id","hash","personId","personDetailsResult","status","buttons","document","getElementById","getElementsByClassName","index","length","setAttribute","removeAttribute","queryParams","parameter","substring"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { RouteComponentProps } from 'react-router-dom';\nimport CaseIdSearch from '../components/SearchPage/CaseIdSearch';\nimport InfoSearch from '../components/SearchPage/InfoSearch';\nimport ApiClient, { RequestResult } from '../clients/ApiClient';\nimport DataContent from '../components/DataContent';\nimport { Text } from '../tools/ConfigurableContent';\nimport { getHash } from '../tools/Obfuscation';\n\ninterface SearchPageProps extends RouteComponentProps {\n  client: ApiClient\n}\n\ntype SearchPageState = {\n  searchApiSupportedResult?: RequestResult<boolean>\n}\n\nclass SearchPage extends React.Component<SearchPageProps, SearchPageState> {\n  constructor(props: SearchPageProps) {\n    super(props);\n    this.state = {}\n  }\n\n  componentDidMount() {\n    this.props.client.isSearchApiSupported().then(result => {\n      this.setState({ searchApiSupportedResult: result });\n    })\n  }\n\n  render() {\n      return (\n        <div id=\"SearchPage\" className=\"SearchPage\">\n          <h1>Find Service Involvement</h1>\n          <div className=\"govuk-hint\">\n                    {Text.Search.Introduction}\n            </div>\n          <DataContent result={this.state.searchApiSupportedResult}>\n            <InfoSearch search={(info: { [id: string]: string }) => navigateToSearch(info, this.props)} />\n          </DataContent>\n        <CaseIdSearch search={(caseId: string) => searchForCaseId(caseId, this.props)} />\n      </div>\n    );\n  }\n}\n\nfunction searchForCaseId(caseId: string, props: SearchPageProps) : Promise<boolean> {\n    setButtonsDisabledStatus(true);\n\n    return props.client.getPerson(caseId, \"cms\").then(response => {\n      setButtonsDisabledStatus(false);\n\n      if (response.success) {\n        props.history.push({\n          pathname: `/person/${response.data?.id}`,\n          hash: getHash({personId: response.data?.id || \"\"}),\n          state: { personDetailsResult: response }\n        })\n        return true;\n      }\n\n      return false;\n    })\n}\n\nfunction setButtonsDisabledStatus(status: boolean) {\n  var buttons = document.getElementById(\"SearchPage\")?.getElementsByClassName(\"govuk-button\") || [];\n    for (var index = 0; index < buttons.length; index++) {\n      if (status) {\n        buttons[index].setAttribute('disabled', 'true')\n      } else {\n        buttons[index].removeAttribute('disabled')\n      }\n    }\n}\n\nfunction navigateToSearch(info: { [id: string]: string }, props: RouteComponentProps): void {\n  var queryParams = \"\"\n  for (var parameter in info) {\n    queryParams += `${parameter}=${info[parameter]}&`\n  }\n  queryParams.substring(0, queryParams.length - 1);\n  props.history.push(\"search?\" + queryParams);\n}\n\nexport default SearchPage;"]},"metadata":{},"sourceType":"module"}