{"ast":null,"code":"import _objectSpread from \"/Users/matthewpugh/Projects/family-context-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _classCallCheck from \"/Users/matthewpugh/Projects/family-context-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/matthewpugh/Projects/family-context-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/matthewpugh/Projects/family-context-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/matthewpugh/Projects/family-context-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/matthewpugh/Projects/family-context-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/matthewpugh/Projects/family-context-ui/src/pages/ResultsPage.tsx\";\nimport React from 'react';\nimport ResultsInfo from '../components/ResultsPage/ResultsInfo';\nimport ResultsList from '../components/ResultsPage/ResultsList';\nimport NavigationButtons from '../components/NavigationButtons';\nimport DataContent from '../components/DataContent';\nimport { getHash } from '../tools/Obfuscation';\n\nvar ResultsPage = /*#__PURE__*/function (_React$Component) {\n  _inherits(ResultsPage, _React$Component);\n\n  function ResultsPage() {\n    _classCallCheck(this, ResultsPage);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(ResultsPage).apply(this, arguments));\n  }\n\n  _createClass(ResultsPage, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this = this;\n\n      this.props.client.searchPerson(getSearchDetails(this.props)).then(function (result) {\n        var updatedResult = _objectSpread({}, result, {\n          success: result.success && result.data != null && result.data.results.length > 0\n        });\n\n        _this.setState({\n          result: updatedResult\n        });\n      });\n    }\n  }, {\n    key: \"navigateToPerson\",\n    value: function navigateToPerson(person) {\n      this.props.history.push({\n        pathname: \"/person/\".concat(person.id),\n        hash: getHash({\n          personId: person.id || \"\"\n        }),\n        state: {\n          personDetailsResult: {\n            data: person,\n            success: true,\n            status: 200\n          }\n        }\n      });\n    }\n  }, {\n    key: \"navigatePage\",\n    value: function navigatePage(pagination) {\n      var searchDetails = getSearchDetails(this.props);\n      this.props.history.push(\"search\" + \"?firstName=\".concat(searchDetails.firstName) + \"&lastName=\".concat(searchDetails.lastName) + \"\".concat(searchDetails.dateOfBirth ? \"&dateOfBirth=\".concat(searchDetails.dateOfBirth) : \"\") + \"\".concat(pagination.pageNumber ? \"&pageNumber=\".concat(pagination.pageNumber) : \"\") + \"\".concat(pagination.resultsPerPage ? \"&resultsPerPage=\".concat(pagination.resultsPerPage) : \"\"));\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state,\n          _this$state2,\n          _this$state2$result,\n          _this$state2$result$d,\n          _this$state3,\n          _this$state3$result,\n          _this2 = this;\n\n      return React.createElement(\"div\", {\n        className: \"ResultsPage\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 53\n        },\n        __self: this\n      }, React.createElement(NavigationButtons, Object.assign({}, this.props, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 54\n        },\n        __self: this\n      })), React.createElement(DataContent, {\n        result: (_this$state = this.state) === null || _this$state === void 0 ? void 0 : _this$state.result,\n        loading: React.createElement(ResultsLoading, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 55\n          },\n          __self: this\n        }),\n        error: React.createElement(MatchesNotFound, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 55\n          },\n          __self: this\n        }),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 55\n        },\n        __self: this\n      }, React.createElement(ResultsInfo, {\n        search: getSearchDetails(this.props),\n        matches: ((_this$state2 = this.state) === null || _this$state2 === void 0 ? void 0 : (_this$state2$result = _this$state2.result) === null || _this$state2$result === void 0 ? void 0 : (_this$state2$result$d = _this$state2$result.data) === null || _this$state2$result$d === void 0 ? void 0 : _this$state2$result$d.results.length) || 0,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 56\n        },\n        __self: this\n      }), React.createElement(ResultsList, {\n        response: ((_this$state3 = this.state) === null || _this$state3 === void 0 ? void 0 : (_this$state3$result = _this$state3.result) === null || _this$state3$result === void 0 ? void 0 : _this$state3$result.data) || {\n          results: []\n        },\n        navigatePage: function navigatePage(paginationDetails) {\n          return _this2.navigatePage(paginationDetails);\n        },\n        navigateToPerson: function navigateToPerson(person) {\n          return _this2.navigateToPerson(person);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 57\n        },\n        __self: this\n      })));\n    }\n  }]);\n\n  return ResultsPage;\n}(React.Component);\n\nvar ResultsLoading = function ResultsLoading() {\n  return React.createElement(\"div\", {\n    className: \"govuk-heading-m\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70\n    },\n    __self: this\n  }, \"Searching for matches...\");\n};\n\nvar MatchesNotFound = function MatchesNotFound() {\n  return React.createElement(\"div\", {\n    className: \"govuk-heading-m\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78\n    },\n    __self: this\n  }, \"No matches found\");\n};\n\nfunction getSearchDetails(props) {\n  var params = new URLSearchParams(props.location.search);\n  var dateParam = params.get('dateOfBirth');\n  var dateOfBirth = dateParam == null ? \"\" : dateParam;\n  var pageNumber = Number(params.get('pageNumber'));\n  var resultsPerPage = Number(params.get('resultsPerPage')) || undefined;\n  var paginationDetails = pageNumber ? {\n    pageNumber: pageNumber,\n    resultsPerPage: resultsPerPage\n  } : undefined;\n  return {\n    firstName: params.get('firstName') || \"\",\n    lastName: params.get('lastName') || \"\",\n    dateOfBirth: dateOfBirth,\n    paginationDetails: paginationDetails\n  };\n}\n\nexport default ResultsPage;","map":{"version":3,"sources":["/Users/matthewpugh/Projects/family-context-ui/src/pages/ResultsPage.tsx"],"names":["React","ResultsInfo","ResultsList","NavigationButtons","DataContent","getHash","ResultsPage","props","client","searchPerson","getSearchDetails","then","result","updatedResult","success","data","results","length","setState","person","history","push","pathname","id","hash","personId","state","personDetailsResult","status","pagination","searchDetails","firstName","lastName","dateOfBirth","pageNumber","resultsPerPage","paginationDetails","navigatePage","navigateToPerson","Component","ResultsLoading","MatchesNotFound","params","URLSearchParams","location","search","dateParam","get","Number","undefined"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { RouteComponentProps } from 'react-router-dom';\nimport SearchDetails from '../models/SearchDetails';\nimport ResultsInfo from '../components/ResultsPage/ResultsInfo';\nimport ResultsList from '../components/ResultsPage/ResultsList';\nimport NavigationButtons from '../components/NavigationButtons';\nimport ApiClient, { RequestResult } from '../clients/ApiClient';\nimport DataContent from '../components/DataContent';\nimport SearchResponse from '../models/SearchResponse';\nimport PaginationDetails from '../models/PaginationDetails';\nimport PersonDetails from '../models/PersonDetails';\nimport { getHash } from '../tools/Obfuscation';\n\ninterface ResultsPageProps extends RouteComponentProps {\n    client: ApiClient\n}\n\ntype ResultsPageState = {\n    result?: RequestResult<SearchResponse>,\n}\n\nclass ResultsPage extends React.Component<ResultsPageProps, ResultsPageState> {\n\n    componentDidMount() {\n        this.props.client.searchPerson(getSearchDetails(this.props)).then(result => {\n            var updatedResult = {...result, success: result.success && result.data != null && result.data.results.length > 0}\n\n            this.setState({result: updatedResult})\n        })\n    }\n\n    navigateToPerson(person: PersonDetails) {\n        this.props.history.push({\n            pathname: `/person/${person.id}`,\n            hash: getHash({personId: person.id || \"\"}),\n            state: { personDetailsResult: {data: person, success: true, status: 200} }\n        })\n    }\n\n    navigatePage(pagination: PaginationDetails) {\n        var searchDetails = getSearchDetails(this.props)\n\n        this.props.history.push(\"search\"\n        +`?firstName=${searchDetails.firstName}`\n        +`&lastName=${searchDetails.lastName}`\n        +`${searchDetails.dateOfBirth ? `&dateOfBirth=${searchDetails.dateOfBirth}` : \"\"}`\n        +`${pagination.pageNumber ? `&pageNumber=${pagination.pageNumber}` : \"\"}`\n        +`${pagination.resultsPerPage ? `&resultsPerPage=${pagination.resultsPerPage}` : \"\"}`)\n    }\n\n    render() {\n        return (\n          <div className=\"ResultsPage\">\n            <NavigationButtons {...this.props}/>\n            <DataContent result={this.state?.result} loading={<ResultsLoading/>} error={<MatchesNotFound/>}>\n                <ResultsInfo search={getSearchDetails(this.props)} matches={this.state?.result?.data?.results.length || 0} />\n                <ResultsList \n                  response={this.state?.result?.data || {results: []}} \n                  navigatePage={(paginationDetails: PaginationDetails) => this.navigatePage(paginationDetails)} \n                  navigateToPerson={(person: PersonDetails) => this.navigateToPerson(person)}\n                />\n            </DataContent>\n          </div>\n        )\n    }\n}\n\nconst ResultsLoading: React.FC = () => {\n    return (\n        <div className=\"govuk-heading-m\">\n            Searching for matches...\n        </div>\n    );\n}\n\nconst MatchesNotFound: React.FC = () => {\n    return (\n        <div className=\"govuk-heading-m\">\n            No matches found\n        </div>\n    );\n}\n\nfunction getSearchDetails(props: RouteComponentProps): SearchDetails {\n    var params = new URLSearchParams(props.location.search)\n\n    var dateParam = params.get('dateOfBirth')\n    var dateOfBirth = (dateParam == null) ? \"\" : dateParam\n\n    var pageNumber = Number(params.get('pageNumber'))\n    var resultsPerPage = Number(params.get('resultsPerPage')) || undefined\n\n    var paginationDetails = pageNumber ? {\n        pageNumber,\n        resultsPerPage\n    } : undefined\n\n    return {\n        firstName: params.get('firstName') || \"\",\n        lastName: params.get('lastName') || \"\",\n        dateOfBirth: dateOfBirth,\n        paginationDetails\n    }\n}\n  \nexport default ResultsPage;"]},"metadata":{},"sourceType":"module"}